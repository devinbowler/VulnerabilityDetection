document.getElementById('scanButton').addEventListener('click', function() {
    var form = document.getElementById('uploadForm');
    var formData = new FormData(form);

    document.getElementById('loader').style.display = 'block';  // Show loading animation.

    fetch("https://your-backend-server.com/", {
        method: "POST",
        body: formData
    }).then(response => response.json()).then(data => {
        document.getElementById('loader').style.display = 'none';  // Hide loading animation.
        if (data.result) {
            document.querySelector('.result-header').innerHTML = 'Scan Result: <span class="result-text">' + data.result + '</span>';
        }
        if (data.explanation) {
            document.querySelector('.explanation').innerHTML = '<h3>Explanation:</h3><p>' + data.explanation + '</p>';
        }
    }).catch(error => {
        console.error('Error:', error);
        document.getElementById('loader').style.display = 'none';  // Hide loading animation on error.
    });
});

function previewFile() {
    var file = document.querySelector('input[type=file]').files[0];
    var reader = new FileReader();
    reader.onloadend = function() {
        document.getElementById('codePreview').textContent = reader.result;
        document.querySelector('.result-header').innerHTML = '';  // Clear previous results
        document.querySelector('.explanation').innerHTML = '';  // Clear previous explanations
    };
    if (file) {
        reader.readAsText(file);
    } else {
        document.getElementById('codePreview').textContent = '';
        document.querySelector('.result-header').innerHTML = '';
        document.querySelector('.explanation').innerHTML = '';
    }
}
